# Lesson: Session Timeout during Workspace Analysis

## ðŸ“Œ èƒŒæ™¯
åœ¨ä½¿ç”¨ `/image` æˆ– `analyze_workspace` æŒ‡ä»¤åˆ†æžè¼ƒå¤§åž‹æˆ–è¤‡é›œçš„ Dynamo åœ–è¡¨æ™‚ï¼Œç™¼ç¾é€£ç·šç¶“å¸¸è¢«ä¼ºæœå™¨è‡ªå‹•åˆ‡æ–·ï¼Œå›žå ± `[FAIL] å¤±æ•—: No active Dynamo connections.`ã€‚

## ðŸ” å•é¡Œè¨ºæ–·
1. **é€¾æ™‚æ©Ÿåˆ¶éŽæ–¼åš´è‹›**ï¼š`server.py` ä¸­çš„ `WebSocketManager.cleanup_stale_sessions` é è¨­è¶…æ™‚æ™‚é–“ç‚º 30.0 ç§’ã€‚
2. **åˆ†æžè€—æ™‚**ï¼šç•¶åœ–è¡¨ç¯€é»žæ•¸é‡è¼ƒå¤š (å¦‚æœ¬æ¡ˆä¾‹ 127 å€‹ç¯€é»ž) æ™‚ï¼Œå¾ž Dynamo å›žå‚³è³‡æ–™åˆ° AI è™•ç†åˆ†æžçš„éŽç¨‹ä¸­ï¼Œè‹¥è¶…éŽ 30 ç§’æœªæœ‰æ–°æŒ‡ä»¤ï¼Œæœƒè©±æœƒè¢«æ¨™è¨˜ç‚º `stale` ä¸¦åœ¨ä¸‹æ¬¡ `analyze_workspace` å‘¼å«æ™‚è¢«æ¸…é™¤ã€‚
3. **å¹½éˆç¾è±¡**ï¼š`list_sessions` å¯èƒ½ä»çœ‹å¾—åˆ°æœƒè©± (å› ç‚ºå®ƒä¸ä¸»å‹•æ¸…ç†)ï¼Œä½† `analyze_workspace` æœƒè§¸ç™¼æ¸…ç†é‚è¼¯å°Žè‡´å¤±æ•ˆã€‚

## ðŸ› ï¸ è§£æ±ºæ–¹æ¡ˆ
1. **æé«˜é€¾æ™‚é–¾å€¼**ï¼šå°‡ `cleanup_stale_sessions` çš„é è¨­ `timeout` å¾ž `30.0` æé«˜è‡³ `300.0` (5 åˆ†é˜)ã€‚
2. **å„ªåŒ–å»ºè­°**ï¼šåœ¨åŸ·è¡Œå¤§åž‹åˆ†æžå‰ï¼Œæ‡‰ç¢ºä¿ Dynamo ç«¯è™•æ–¼æ´»å‹•ç‹€æ…‹ã€‚

## âœ… é©—è­‰çµæžœ
- ä¿®æ­£å¾Œï¼ŒæˆåŠŸå®Œæˆå°ã€Œæœ€å¤§åŒ–çª—å¤–è¦–é‡Ž.dynã€(127 ç¯€é»ž, 158 é€£ç·š) çš„å®Œæ•´åˆ†æžã€‚
- AI èƒ½å¤ ç©©å®šç²å–è³‡æ–™ä¸¦ç”Ÿæˆ Mermaid åœ–è¡¨ã€‚

## ðŸ“ å½±éŸ¿ç¯„åœ
- `bridge/python/server.py` -> `WebSocketManager.cleanup_stale_sessions`
